name: OpenSCM-CI
on: [push]
runs-on: ubuntu-latest

jobs:
  build:
    steps:
    - name: Documentation
      uses: swillner/actions/python-run@python-3.7
      # treat warnings as errors (-W)
      # ...but not when being nitpicky (-n)
      run: |
        pip install -e .[docs]
        sphinx-build -M html docs docs/build -qW
        sphinx-build -M html docs docs/build -Eqn -b coverage
        if [[ -s docs/build/html/python.txt ]]
        then
            echo
            echo "Error: Documentation missing:"
            echo
            cat docs/build/html/python.txt
            exit 1
        fi
